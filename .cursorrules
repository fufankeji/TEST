# ============================================================
# AI 驱动开发工作流规范
# ============================================================
#
# 说明：
#    - Issue ID 格式：<团队Key>-<数字>（由 Linear 自动生成）
#    - 例如团队 Key 为 "VB"，则 Issue 为 VB-1, VB-2...
#    - 团队 Key 可在 Linear Team Settings 中修改
#
# ============================================================

---

## 一、项目配置

```yaml
project:
  name: "电商管理平台"          # 当前项目名称
  team: "TES"            # Linear 团队名（Key: VB）
  repo: "https://github.com/fufankeji/TEST.git"                      # GitHub 仓库地址
```

> Issue 前缀（如 VB）由 Linear 团队 Key 决定
> 修改方式：Linear → Team Settings → Identifier

---

## 二、核心工作流

### 2.1 触发词映射

| 自然语言命令 | AI 执行 |
|--------|---------|
| "创建项目 XXX" | 创建 Linear Project + 拆分 Issues |
| "新建任务 XXX" | 创建 Linear Issue |
| "开始做 `<ID>`" | Issue → In Progress，告知分支名 |
| "完成了" / "搞定" | Issue → Done，生成 commit message |
| "取消 `<ID>`" | Issue → Canceled |
| "列出任务" / "待办" / "进度" | 显示任务列表和完成度 |
| "提交代码" / "推送" | git add + commit + push |
| "创建分支 `<ID>`" | git checkout -b feature/`<ID>`-xxx |
| "同步到 Linear" / "根据 plan 创建任务" | 读取 Plan MD 文件，创建 Linear Project + Issues |

> `<ID>` = Issue 标识符，如 `VB-10`、`AUTH-5`

---

## 三、Git 规范

### 3.1 分支命名

```
<type>/<issue-id>-<description>

类型：feature | fix | hotfix | docs | refactor
示例：feature/VB-10-user-login
```

### 3.2 Commit Message

```
<type>(<scope>): <description> <issue-id>

类型：feat | fix | docs | style | refactor | perf | test | chore
示例：feat(auth): 实现用户登录 VB-10
```

---

## 四、AI 行为规范

### 开始任务时
1. 调用 `update_issue` → In Progress
2. 输出任务详情 + 推荐分支名
3. 询问是否创建分支

### 完成任务时
1. 调用 `update_issue` → Done
2. 生成规范 commit message
3. 询问是否提交推送

### 查看进度时
1. 调用 `list_issues` 获取任务
2. 计算完成百分比
3. 格式化输出任务表格

### Plan 模式同步时
当用户说"同步到 Linear"、"根据 plan 创建任务"或提供 Plan MD 文件时：

1. **读取 Plan 文件**
   - 识别项目名称（通常是一级标题）
   - 提取功能模块/任务列表（通常是列表项或二级标题）

2. **解析任务**
   - 从 `- [ ]` 或 `- ` 开头的行提取任务
   - 识别优先级标记（如：高、中、低 或 P0、P1、P2）
   - 识别模块分类（如：[用户]、[订单]）

3. **创建 Linear 内容**
   - 调用 `create_project` 创建项目
   - 调用 `create_issue` 为每个任务创建 Issue
   - 设置优先级和标签

4. **输出结果**
   ```
   ✅ 已根据 Plan 创建项目：XXX
   
   📋 创建的任务：
   | ID | 任务 | 优先级 |
   |----|------|--------|
   | TES-1 | 任务1 | 🔴 High |
   | TES-2 | 任务2 | 🟡 Medium |
   ...
   ```

### Plan 文件推荐格式

```markdown
# 项目名称

## 功能模块

### 模块A
- [ ] 任务1（优先级：高）
- [ ] 任务2（优先级：中）

### 模块B  
- [ ] 任务3（优先级：高）
- [ ] 任务4（优先级：低）
```

---

## 五、Issue 规范

### 标题格式
```
[模块] 动作描述
示例：[用户] 实现登录功能
```

### 优先级
- 🔥 Urgent (1): 立即处理
- 🔴 High (2): 当天完成
- 🟡 Medium (3): 本周完成
- 🟢 Low (4): 有空再做
